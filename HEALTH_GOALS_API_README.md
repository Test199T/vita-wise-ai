# Health Goals API - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

## ЁЯУЛ р╕ар╕▓р╕Юр╕гр╕зр╕б

API р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕г Health Goals р╣Гр╕Щр╕гр╕░р╕Ър╕Ъ VitaWise AI р╣Вр╕Фр╕вр╣Гр╕Кр╣Й endpoint `POST /health-goals` р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╣Гр╕лр╕бр╣И

## ЁЯЪА р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕Вр╣Йр╕нр╕бр╕╣р╕е API

- **Endpoint:** `POST http://localhost:3000/health-goals`
- **Authorization:** `Bearer {{auth_token}}`
- **Content-Type:** `application/json`

### 2. Request Body

```json
{
  "goal_type": "weight_loss",
  "title": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 5 р╕Бр╕┤р╣Вр╕ер╕Бр╕гр╕▒р╕б",
  "description": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ",
  "target_value": 5,
  "current_value": 0,
  "unit": "kg",
  "start_date": "2024-01-01",
  "target_date": "2024-06-01",
  "priority": "medium"
}
```

### 3. р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Гр╕Щр╣Вр╕Др╣Йр╕Ф

#### Import р╣Бр╕ер╕░ Setup

```typescript
import { apiService, HealthGoals } from "@/services/api";
```

#### р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й API

```typescript
const createHealthGoal = async () => {
  try {
    const healthGoalData: HealthGoals = {
      goal_type: "weight_loss",
      title: "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 5 р╕Бр╕┤р╣Вр╕ер╕Бр╕гр╕▒р╕б",
      description: "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ",
      target_value: 5,
      current_value: 0,
      unit: "kg",
      start_date: "2024-01-01",
      target_date: "2024-06-01",
      priority: "medium"
    };

    const result = await apiService.createHealthGoal(healthGoalData);
    console.log('Health Goal created:', result);
    
  } catch (error) {
    console.error('Error creating health goal:', error);
  }
};
```

## ЁЯзк р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### 1. р╕Чр╕Фр╕кр╕нр╕Ър╕Ьр╣Ир╕▓р╕Щ Frontend

р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Health Goals р╕бр╕╡р╕Ыр╕╕р╣Ир╕б "р╕Чр╕Фр╕кр╕нр╕Ъ API" р╕Чр╕╡р╣Ир╕Ир╕░р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й API р╣Вр╕Фр╕вр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

### 2. р╕Чр╕Фр╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в JavaScript

```bash
# р╕гр╕▒р╕Щр╣Др╕Яр╕ер╣Мр╕Чр╕Фр╕кр╕нр╕Ъ
node test-health-goals-api.js

# р╕лр╕гр╕╖р╕нр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ token р╣Бр╕ер╣Йр╕зр╕гр╕▒р╕Щ
AUTH_TOKEN=your_jwt_token node test-health-goals-api.js
```

### 3. р╕Чр╕Фр╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в cURL

```bash
# р╕гр╕▒р╕Щ script shell
bash test-health-goals-curl.sh

# р╕лр╕гр╕╖р╕нр╕гр╕▒р╕Щр╕Фр╣Йр╕зр╕в cURL р╣Вр╕Фр╕вр╕Хр╕гр╕З
curl -X POST http://localhost:3000/health-goals \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your_token_here" \
  -d '{
    "goal_type": "weight_loss",
    "title": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 5 р╕Бр╕┤р╣Вр╕ер╕Бр╕гр╕▒р╕б",
    "description": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ",
    "target_value": 5,
    "current_value": 0,
    "unit": "kg",
    "start_date": "2024-01-01",
    "target_date": "2024-06-01",
    "priority": "medium"
  }'
```

### 4. р╕Чр╕Фр╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в Postman

1. **Method:** POST
2. **URL:** `http://localhost:3000/health-goals`
3. **Headers:**
   - `Content-Type: application/json`
   - `Authorization: Bearer {{auth_token}}`
4. **Body:** р╣Гр╕Кр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Фр╣Йр╕▓р╕Щр╕Ър╕Щ

## ЁЯУК Response Format

### Success Response (200/201)

```json
{
  "data": {
    "goal_type": "weight_loss",
    "title": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 5 р╕Бр╕┤р╣Вр╕ер╕Бр╕гр╕▒р╕б",
    "description": "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ",
    "target_value": 5,
    "current_value": 0,
    "unit": "kg",
    "start_date": "2024-01-01",
    "target_date": "2024-06-01",
    "priority": "medium",
    "status": "active",
    "id": "generated_id"
  },
  "message": "Health goal created successfully"
}
```

### Error Responses

#### 400 Bad Request
```json
{
  "message": "Bad Request: р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З",
  "errors": {
    "goal_type": ["goal_type is required"],
    "title": ["title is required"]
  },
  "status": 400
}
```

#### 401 Unauthorized
```json
{
  "message": "Unauthorized: р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╣Гр╕лр╕бр╣И",
  "status": 401
}
```

#### 500 Internal Server Error
```json
{
  "message": "Internal Server Error: р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╕Чр╕╡р╣Ир╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М",
  "status": 500
}
```

## ЁЯФз р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓

### 1. API Base URL

р╣Бр╕Бр╣Йр╣Др╕Вр╣Гр╕Щ `src/services/api.ts`:

```typescript
const API_BASE_URL = 'http://localhost:3000'; // р╕лр╕гр╕╖р╕н port р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
```

### 2. Authentication Token

Token р╕Ир╕░р╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕Ьр╣Ир╕▓р╕Щ `Authorization` header р╣Вр╕Фр╕вр╣Гр╕Кр╣Й `tokenUtils.getValidToken()`

### 3. Timeout

API р╕бр╕╡ timeout 10 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Фр╣Йр╣Гр╕Щ `AbortSignal.timeout(10000)`

## ЁЯУЭ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З API

| Field | Type | Required | Description | Example |
|-------|------|----------|-------------|---------|
| `goal_type` | string | тЬЕ | р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в | `"weight_loss"` |
| `title` | string | тЬЕ | р╕Кр╕╖р╣Ир╕нр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в | `"р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 5 р╕Бр╕┤р╣Вр╕ер╕Бр╕гр╕▒р╕б"` |
| `description` | string | тЭМ | р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в | `"р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ"` |
| `target_value` | number | тЬЕ | р╕Др╣Ир╕▓р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в | `5` |
| `current_value` | number | тЭМ | р╕Др╣Ир╕▓р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ | `0` |
| `unit` | string | тЭМ | р╕лр╕Щр╣Ир╕зр╕вр╕Вр╕нр╕Зр╕Др╣Ир╕▓ | `"kg"` |
| `start_date` | string | тЬЕ | р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕┤р╣Ир╕б | `"2024-01-01"` |
| `target_date` | string | тЬЕ | р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕кр╕┤р╣Йр╕Щр╕кр╕╕р╕Ф | `"2024-06-01"` |
| `priority` | string | тЭМ | р╕Др╕зр╕▓р╕бр╕кр╕│р╕Др╕▒р╕Н | `"medium"` |

### р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ

- `weight_loss` - р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б
- `weight_gain` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б
- `muscle_gain` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕ер╣Йр╕▓р╕бр╣Ар╕Щр╕╖р╣Йр╕н
- `endurance` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕Чр╕Щр╕Чр╕▓р╕Щ
- `flexibility` - р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ
- `stress_reduction` - р╕ер╕Фр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Ф
- `sleep_improvement` - р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Щр╕нр╕Щ
- `nutrition` - р╣Вр╕ар╕Кр╕Щр╕▓р╕Бр╕▓р╕г
- `other` - р╕нр╕╖р╣Ир╕Щр╣Ж

### р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕кр╕│р╕Др╕▒р╕Н

- `low` - р╕Хр╣Ир╕│
- `medium` - р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З
- `high` - р╕кр╕╣р╕З
- `urgent` - р╣Ар╕гр╣Ир╕Зр╕Фр╣Ир╕зр╕Щ

## ЁЯЪи р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Error

### 1. Token р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

```typescript
if (error.message === 'No valid authentication token found') {
  // Redirect р╣Др╕Ыр╕лр╕Щр╣Йр╕▓ login
  // р╕лр╕гр╕╖р╕нр╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕лр╣Й login р╣Гр╕лр╕бр╣И
}
```

### 2. р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

```typescript
if (error.message.includes('Bad Request')) {
  // р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б error р╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
  // р╕лр╕гр╕╖р╕н highlight field р╕Чр╕╡р╣Ир╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓
}
```

### 3. Server Error

```typescript
if (error.message.includes('Internal Server Error')) {
  // р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓р╣Ар╕Бр╕┤р╕Фр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М
  // р╕лр╕гр╕╖р╕нр╕ер╕нр╕Зр╣Гр╕лр╕бр╣Ир╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З
}
```

## ЁЯУБ р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З

- `src/services/api.ts` - API service р╣Бр╕ер╕░р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ `createHealthGoal`
- `src/pages/HealthGoals.tsx` - р╕лр╕Щр╣Йр╕▓ UI р╣Бр╕ер╕░р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й API
- `test-health-goals-api.js` - р╣Др╕Яр╕ер╣Мр╕Чр╕Фр╕кр╕нр╕Ъ JavaScript
- `test-health-goals-curl.sh` - Script р╕Чр╕Фр╕кр╕нр╕Ъ cURL
- `API_EXAMPLE.md` - р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ API
- `HEALTH_GOALS_API_README.md` - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Щр╕╡р╣Й

## ЁЯФН р╕Бр╕▓р╕г Debug

### 1. р╣Ар╕Ыр╕┤р╕Ф Console Log

API service р╕Ир╕░р╣Бр╕кр╕Фр╕З log р╕Хр╣Ир╕▓р╕Зр╣Ж р╣Гр╕Щ console:
- ЁЯОп р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
- ЁЯУб Response status
- тЬЕ р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И
- тЭМ Error р╕Чр╕╡р╣Ир╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ

### 2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Network Tab

р╕Фр╕╣ request/response р╣Гр╕Щ Developer Tools > Network tab

### 3. р╕Чр╕Фр╕кр╕нр╕Ъ API р╣Вр╕Фр╕вр╕Хр╕гр╕З

р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣Мр╕Чр╕Фр╕кр╕нр╕Ър╕лр╕гр╕╖р╕н cURL р╣Ар╕Юр╕╖р╣Ир╕нр╕Чр╕Фр╕кр╕нр╕Ъ API р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Ьр╣Ир╕▓р╕Щ frontend

## ЁЯТб р╣Ар╕Др╕ер╣Зр╕Фр╕ер╕▒р╕Ъ

1. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Token:** р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ token р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕
2. **Validate р╕Вр╣Йр╕нр╕бр╕╣р╕е:** р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╣Др╕Ыр╕зр╣Ир╕▓р╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
3. **Error Handling:** р╕Ир╕▒р╕Фр╕Бр╕▓р╕г error р╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╕Бр╕▒р╕Ъ UX
4. **Loading State:** р╣Бр╕кр╕Фр╕З loading state р╕Вр╕Ур╕░р╣Ар╕гр╕╡р╕вр╕Б API
5. **Retry Logic:** р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕ер╕нр╕Зр╣Гр╕лр╕бр╣Ир╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Ф error

## ЁЯЖШ р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

1. **401 Unauthorized**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ token р╕зр╣Ир╕▓р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ token р╕вр╕▒р╕Зр╣Др╕бр╣Ир╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕

2. **400 Bad Request**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╣Др╕Ыр╕зр╣Ир╕▓р╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ format р╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е

3. **500 Internal Server Error**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ backend server р╕Чр╕│р╕Зр╕▓р╕Щр╕нр╕вр╕╣р╣И
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ log р╕Вр╕нр╕З backend

4. **Connection Timeout**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ network connection
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ firewall settings

### р╕Хр╕┤р╕Фр╕Хр╣Ир╕н Support

р╕лр╕▓р╕Бр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Фр╣Й р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓
